## Spring Security 와 JWT를 이용한 로그인 구현



#### **시나리오**

1. 이메일과 사용자 이름, 비밀번호를 받아 회원 등록
2. 로그인하면 JWT 토큰 반환
3. 서버에 요청 전송 시 헤더에 JWT 값이 있는지 확인하고, 사용자의 Role에 따라서도 접근 여부 확인 후 리소스 접근



#### 진행 항목

**Security 설정:**

- Spring Security 및 JWT 관련 의존성을 프로젝트에 추가합니다.

**사용자 인증 서비스 구현:**

- `UserDetailsService`를 구현하여 사용자 정보를 가져오는 서비스를 작성합니다.

**비밀번호 인코딩:**

- 사용자 비밀번호를 안전하게 저장하기 위해 비밀번호 인코딩을 적용합니다.

**JWT 토큰 생성 및 검증:**

- JWT 토큰을 생성하고, 토큰의 유효성을 검사하는 데 필요한 클래스 및 메서드를 작성합니다.

**로그인 API 엔드포인트 구현:**

- 로그인을 처리하는 API 엔드포인트를 생성하고, 사용자가 제공한 자격 증명을 기반으로 JWT 토큰을 생성합니다.

**사용자 정보 수정 및 삭제 API 구현:**

- 로그인한 사용자가 자신의 정보를 수정하거나 계정을 삭제하는 API를 구현합니다.

**사용자 권한 관리:**

- 관리자 권한을 가진 사용자에 대한 권한 관리 기능을 추가합니다.
- 관리자가 사용자의 역할을 변경하거나 권한을 부여/제거할 수 있는 API를 구현합니다.

**JWT 토큰 전송:**

- 로그인 성공 시 생성된 JWT 토큰을 클라이언트에게 안전하게 전송합니다. 일반적으로는 응답의 헤더나 본문에 포함됩니다.

**JWT 토큰의 만료 시간 설정:**

- JWT 토큰의 만료 시간을 설정하고, 만료 전에 갱신하는 방법을 구현합니다.
- 토큰의 유효성을 검증하면서 만료 시간이 다가올 때 클라이언트에게 새로운 토큰을 제공합니다.

**인증된 엔드포인트 보호:**

- 보호해야 하는 엔드포인트에 대해 Spring Security를 사용하여 인증 및 권한 부여를 구현합니다.

**비밀번호 재설정:**

- 비밀번호를 잊어버린 사용자를 위한 비밀번호 재설정 기능을 구현합니다.

**로그인 이력 기록:**

- 사용자의 로그인 이력을 기록하여 보안 감시 및 로그 분석을 위한 정보를 수집합니다.

**로그아웃 토큰 블랙리스트 관리:**

- 로그아웃을 처리하는 API 엔드포인트를 만들고, 필요한 경우 토큰의 무효화 등의 추가 작업을 수행합니다.
- 토큰 블랙리스트에 대한 주기적인 정리 및 관리 기능을 추가하여 시스템 성능을 최적화합니다.

**Swagger를 통한 API 문서 자동화:**

- Swagger나 Spring REST Docs를 활용하여 API에 대한 자동화된 문서를 생성합니다.

**예외 처리:**

- 로그인 실패나 권한 없는 요청 등에 대한 예외 처리를 구현합니다.

**테스트:**

- 작성한 기능에 대한 테스트를 작성하고 실행하여 안정성을 확인합니다.


#### 그 외

**H2 접근 경로**

http://localhost:8080/h2-console



**Swagger 주소**

http://localhost:8080/swagger-ui/index.html
